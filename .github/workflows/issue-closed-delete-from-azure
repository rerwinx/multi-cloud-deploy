name: Issue Closed - Deelete from Azure

# Runs when an issue is created.
on:
  issues:
    types: [closed] 
    
jobs:
  
  delete-from-azure:
  
    env:
      WEBAPP_NAME: rerwinx-multicloud-web 
    
    if: startsWith(github.event.issue.title, 'Deploy to Azure') 
    
    runs-on: ubuntu-latest
    
    steps:
     
      - name: 'Login via Azure CLI'
        uses: azure/login@v1
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
    
      - uses: azure/docker-login@v1
        with:
          login-server: docker.pkg.github.com
          username: ${{ github.actor }}
          password: ${{secrets.GP_TOKEN}}
    
      - name: Create the web app
        env:
          RESOURCE_GROUP: rerwinxmulticloud
        run: |
          az webapp delete --resource-group $RESOURCE_GROUP --name $WEBAPP_NAME
        
      - name: Azure logout
        run: |
          az logout
      
